<div class="container mt-4">
  <h2 class="mb-4">Gestión de Stock - Formulario Reactivo</h2>
  
  <div class="row">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h4>Agregar Nuevo Stock</h4>
        </div>
        <div class="card-body">
          <form [formGroup]="stockForm" (ngSubmit)="onSubmit()">
            <div class="mb-3">
              <label for="name" class="form-label">Nombre del Producto</label>
              <input 
                type="text" 
                class="form-control" 
                id="name"
                formControlName="name"
                [class.is-invalid]="submitted && f['name'].errors"
                placeholder="Ingrese el nombre del producto">
              
              <div *ngIf="submitted && f['name'].errors" class="invalid-feedback">
                <div *ngIf="f['name'].errors['required']">
                  El nombre es requerido
                </div>
                <div *ngIf="f['name'].errors['minlength']">
                  El nombre debe tener al menos 3 caracteres
                </div>
              </div>
            </div>

            <div class="mb-3">
              <label for="quantity" class="form-label">Cantidad</label>
              <input 
                type="number" 
                class="form-control" 
                id="quantity"
                formControlName="quantity"
                [class.is-invalid]="submitted && f['quantity'].errors"
                placeholder="Ingrese la cantidad">
              
              <div *ngIf="submitted && f['quantity'].errors" class="invalid-feedback">
                <div *ngIf="f['quantity'].errors['required']">
                  La cantidad es requerida
                </div>
                <div *ngIf="f['quantity'].errors['min']">
                  La cantidad debe ser mayor a 0
                </div>
              </div>
            </div>

            <div class="d-flex gap-2">
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-save"></i> Guardar
              </button>
              <button type="button" class="btn btn-secondary" (click)="onReset()">
                <i class="bi bi-x-circle"></i> Limpiar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-info text-white">
          <h4>Estado del Formulario</h4>
        </div>
        <div class="card-body">
          <div class="mb-2">
            <strong>Válido:</strong> 
            <span [class.text-success]="stockForm.valid" [class.text-danger]="!stockForm.valid">
              {{ stockForm.valid }}
            </span>
          </div>
          <div class="mb-2">
            <strong>Pristine:</strong> 
            <span>{{ stockForm.pristine }}</span>
          </div>
          <div class="mb-2">
            <strong>Touched:</strong> 
            <span>{{ stockForm.touched }}</span>
          </div>
          <div class="mb-3">
            <strong>Valores:</strong>
            <pre class="bg-light p-2 rounded">{{ stockForm.value | json }}</pre>
          </div>
        </div>
      </div>

      <div class="card mt-3">
        <div class="card-header bg-warning">
          <h5>Lista de Stock Actual</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Producto</th>
                  <th>Cantidad</th>
                </tr>
              </thead>
              <tbody>
                @for(stock of stockService.stocklist(); track stock.id) {
                  <tr>
                    <td>{{ stock.id }}</td>
                    <td>{{ stock.name }}</td>
                    <td>
                      <span 
                        [class.badge]="true"
                        [class.bg-danger]="stock.quantity < 10"
                        [class.bg-success]="stock.quantity >= 10">
                        {{ stock.quantity }}
                      </span>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
